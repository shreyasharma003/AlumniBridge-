<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat | AlumniBridge</title>
  <link rel="stylesheet" href="../css/chat.css">
  <!-- SockJS and STOMP for WebSocket -->
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>
<body class="chat-page">
  <!-- Top Navigation Bar -->
  <header class="top-nav-bar">
    <h1 class="nav-title">üí¨ Messages</h1>
    <div class="nav-actions">
      <button class="btn btn-secondary" onclick="goBack()">‚Üê Back to Dashboard</button>
      <button class="btn btn-logout" onclick="logout()">üö™ Logout</button>
    </div>
  </header>

  <div class="chat-shell">
    <!-- Left Sidebar: Connections List -->
    <aside class="chat-sidebar">
      <header class="sidebar-header">
        <h1>Chats</h1>
        <button id="newChatBtn" class="btn-icon" title="New Chat">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M12 5v14M5 12h14"/>
          </svg>
        </button>
      </header>

      <div class="search-box">
        <input type="search" id="sidebarSearch" placeholder="Search conversations..." autocomplete="off">
      </div>

      <div id="connectionsList" class="connections-list">
        <div class="loading"><div class="spinner"></div></div>
      </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="chat-main">
      <!-- Empty State -->
      <div id="emptyState" class="empty-state">
        <div class="empty-icon">üí¨</div>
        <h2>Welcome to Chat</h2>
        <p>Select a connection from the left to start messaging.</p>
      </div>

      <!-- Active Chat Window (hidden initially) -->
      <div id="chatWindow" class="chat-window hidden">
        <header class="chat-header">
          <div class="chat-user-info">
            <div id="chatAvatar" class="avatar"></div>
            <div>
              <h2 id="chatUserName">User Name</h2>
              <span id="chatUserStatus" class="status-text"></span>
            </div>
          </div>
          <div class="chat-actions">
            <button id="viewProfileBtn" class="btn-secondary" title="View Profile">Profile</button>
          </div>
        </header>

        <div id="messagesArea" class="messages-area">
          <!-- Messages render here -->
        </div>

        <footer class="message-input-area">
          <input type="text" id="messageInput" placeholder="Type a message..." autocomplete="off">
          <button id="sendBtn" class="btn-primary">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
          </button>
        </footer>
      </div>
    </main>

    <!-- New Chat Modal -->
    <div id="newChatModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <header class="modal-header">
          <h2>Start New Chat</h2>
          <button id="closeModalBtn" class="btn-icon">&times;</button>
        </header>
        <div class="modal-body">
          <input type="search" id="modalSearch" placeholder="Search connections..." autocomplete="off">
          <div id="modalConnectionsList" class="modal-list"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="../js/chat.js"></script>
</body>
</html>
